<div class='dialog-header'>
    <div class='header-group'>
        <fa-icon [icon]='strongIcon' size='lg' *ngIf='isStrong' title='Strong Response'></fa-icon>
        <fa-icon [icon]='timeIcon' size='lg' *ngIf='isTimeBased' title='Time-Based Response'></fa-icon>
        <fa-icon [icon]='regexIcon' size='lg' *ngIf='isRegex' title='Regex Response'></fa-icon>
        <h3>{{ context.data != null ? context.data.description : 'New Response' }}</h3>
    </div>
    <div class='header-group'>
        <button tuiIconButton *ngIf='form.disabled && isEdit && !(loading || deleting)' appearance='icon' icon='tuiIconEditLarge' (click)='edit()' title='Edit response'></button>
        <tui-loader *ngIf='form.enabled || loading' [showLoader]='loading'>
            <button tuiButton [disabled]='form.invalid || form.untouched || form.disabled' (click)='save()' size='s'>Save</button>
        </tui-loader>
        <tui-loader *ngIf='isEdit && form.disabled && !loading' [showLoader]='deleting'>
            <button tuiIconButton [disabled]='deleting' appearance='icon' icon='tuiIconTrashLarge' (click)='deleteResponse()' title='Delete response'></button>
        </tui-loader>
        <button tuiIconButton appearance='icon' icon='tuiIconCloseLarge' (click)='close()' title='Close'></button>
    </div>
</div>
<form [formGroup]='form'>
    <label tuiLabel label='Description'>
        <tui-input formControlName='description' [tuiTextfieldLabelOutside]='true'></tui-input>
    </label>
    <label tuiLabel [label]='isRegex ? "Pattern" : "Phrase"'>
        <tui-input required formControlName='phrase' [tuiTextfieldLabelOutside]='true'></tui-input>
    </label>
    <label tuiLabel label='Type' class='type'>
        <tui-select formControlName='type' [tuiTextfieldLabelOutside]='true' (ngModelChange)='typeChanged()' [valueContent]='typeForDisplay(form.controls["type"].value)'>
            Types
            <tui-data-list *tuiDataList>
                <tui-opt-group tuiSelectGroup>
                    <button *ngFor='let option of typeOptions' tuiOption [value]='option'>{{ typeForDisplay(option) }}</button>
                </tui-opt-group>
            </tui-data-list>
        </tui-select>
        <tui-input *ngIf='isTimeBased' [required]='isTimeBased' formControlName='timeSchedule'>Cron Schedule</tui-input>
    </label>
    <label tuiLabel [label]='label' formArrayName='responses'>
        <tui-text-area required *ngFor='let res of responsesControl.controls; let i = index' [formControlName]='i'
            [tuiTextfieldLabelOutside]='true' [tuiTextfieldCleaner]='true' (ngModelChange)='responseChanged($event, i)' tuiTextfieldSize='m'></tui-text-area>
    </label>
    <ng-template #label>
        <div class='label'>
            Responses
            <button tuiIconButton appearance='icon' icon='tuiIconPlus' (click)='addResponse()' *ngIf='form.enabled'></button>
        </div>
    </ng-template>
</form>
